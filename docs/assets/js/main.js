"use strict";console.log(">> Ready!");const inputText=document.querySelector(".js-inputText"),btnSearch=document.querySelector(".js-btnSearch"),btnReset=document.querySelector(".js-btnReset"),listFav=document.querySelector(".js-listFav"),listRes=document.querySelector(".js-listRes"),imgEmptyFavs=document.querySelector(".js-imageFav"),imgSearchAnimes=document.querySelector(".js-imageFront"),totalResults=document.querySelector(".js-totalResults");let anime="",arrFavs=[],arrResults=[],arrFix=[20,50,56];function getFromLocalStorage(){const e=localStorage.getItem("anime");null!==e&&(arrFavs=JSON.parse(e),renderFavs(arrFavs))}function handlerClickReset(e){e.preventDefault(),arrFavs=[];let t=document.querySelectorAll(".js-itemList");for(let e=0;e<t.length;e++)t[e].classList.contains("favorit")&&t[e].classList.toggle("favorit");renderFavs(arrFavs),setInLocalStorage(arrFavs),showBtnReset(),hiddenImgEmpyFavs()}function handlerClickDeleteFav(e){const t=e.currentTarget.parentElement.id;let s=document.querySelectorAll(".js-itemList");for(let e=0;e<s.length;e++)t===s[e].id&&s[e].classList.toggle("favorit");for(let e=0;e<arrFavs.length;e++)if(t===arrFavs[e].id){arrFavs.splice(e,1);break}renderFavs(arrFavs),setInLocalStorage(arrFavs)}function saveFavorites(e){let t=e.querySelector("img"),s={name:e.querySelector("p").innerHTML,img:t.src,id:e.id};const r=s.id;let a=!1;if(0===arrFavs.length)arrFavs.push(s);else{for(let e=0;e<arrFavs.length;e++){if(arrFavs[e].id===r){a=!1;break}a=!0}if(!0===a)arrFavs.push(s);else for(let e=0;e<arrFavs.length;e++)if(r===arrFavs[e].id){arrFavs.splice(e,1);break}}return arrFavs}function showBtnReset(){0!==arrFavs.length?btnReset.classList.remove("hidden"):btnReset.classList.add("hidden")}function hiddenImgEmpyFavs(){0!==arrFavs.length?imgEmptyFavs.classList.add("hidden"):imgEmptyFavs.classList.remove("hidden")}function hiddenImgSearchAnimes(){0!==arrResults.length?imgSearchAnimes.classList.add("hidden"):imgSearchAnimes.classList.remove("hidden")}function setInLocalStorage(e){const t=JSON.stringify(e);localStorage.setItem("anime",t)}function renderFavs(e){listFav.innerHTML="";for(let t=0;t<e.length;t++)listFav.innerHTML+=`<li id='${e[t].id}' class='js-itemFav sectionFav__list--item'><img src="${e[t].img}"><p>${e[t].name}</p><i class="fas fa-times-circle js-deleteBtn sectionFav__list--btn"></i></li>`;showBtnReset(),hiddenImgEmpyFavs();const t=document.querySelectorAll(".js-deleteBtn");for(let e=0;e<t.length;e++)t[e].addEventListener("click",handlerClickDeleteFav)}function handlerClickFav(e){const t=e.currentTarget;t.classList.toggle("favorit");const s=saveFavorites(t);setInLocalStorage(s),renderFavs(s)}function takeField(){return inputText.value}function getAnimeResults(){listRes.innerHTML="",""===anime?imgSearchAnimes.classList.remove("hidden"):fetch("https://api.jikan.moe/v3/search/anime?q="+anime).then(e=>e.json()).then(e=>{arrResults=e.results,hiddenImgSearchAnimes(),totalResults.innerHTML="El total de resultados es "+arrResults.length;for(let t=0;t<arrResults.length;t++){const s=e.results[t].image_url,r=e.results[t].title,a=e.results[t].start_date,n=`<li id='${e.results[t].mal_id}' class='js-itemList sectionRes__list--item'><img src="${s}"><p>${r}</p><p>${a}</p></li>`;listRes.innerHTML+=n}const t=document.querySelectorAll(".js-itemList");for(let e=0;e<t.length;e++)t[e].addEventListener("click",handlerClickFav);for(let e=0;e<arrFavs.length;e++){let s=arrFavs[e].id;for(let e=0;e<t.length;e++)t[e].id===s&&t[e].classList.toggle("favorit")}})}function handlerClickSearch(e){e.preventDefault(),anime=takeField(),getAnimeResults()}function handlerClickPar(){for(const e of arrFix)e===arrResults.length?console.log("Item es igual a la longitud"):e<arrResults.length?console.log("Item es menor que la longitud"):e>arrResults.length&&console.log("Item es mayor que la longitud")}getFromLocalStorage(),showBtnReset(),hiddenImgEmpyFavs(),hiddenImgSearchAnimes(),btnSearch.addEventListener("click",handlerClickSearch),btnReset.addEventListener("click",handlerClickReset),totalResults.addEventListener("click",handlerClickPar);